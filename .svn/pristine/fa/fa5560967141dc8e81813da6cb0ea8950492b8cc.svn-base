<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %>

	<%-- * [[개정이력(Modification Information)]] * 수정일 수정자 수정내용 * ---------- --------- ----------------- * 2023.11.07 박민주
		최초작성 * Copyright (c) 2023 by DDIT All right reserved --%>
		<%@taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>

			<style>
				#modal.modal-overlay {
					width: 100%;
					height: 100%;
					position: absolute;
					left: 0;
					top: 0;
					display: none;
					flex-direction: column;
					align-items: center;
					justify-content: center;
					background: rgba(255, 255, 255, 0.25);
					box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
					backdrop-filter: blur(1.5px);
					-webkit-backdrop-filter: blur(1.5px);
					border-radius: 10px;
					border: 1px solid rgba(255, 255, 255, 0.18);
				}

				#modal .modal-window {
					background: rgba(69, 139, 197, 0.70);
					box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
					backdrop-filter: blur(13.5px);
					-webkit-backdrop-filter: blur(13.5px);
					border-radius: 10px;
					border: 1px solid rgba(255, 255, 255, 0.18);
					width: 400px;
					height: 500px;
					position: relative;
					top: -100px;
					padding: 10px;
				}

				#modal .title {
					padding-left: 10px;
					display: inline;
					text-shadow: 1px 1px 2px gray;
					color: white;

				}

				#modal .title h2 {
					display: inline;
				}

				#modal .close-area {
					display: inline;
					float: right;
					padding-right: 10px;
					cursor: pointer;
					text-shadow: 1px 1px 2px gray;
					color: white;
				}

				#modal .content {
					margin-top: 20px;
					padding: 0px 10px;
					text-shadow: 1px 1px 2px gray;
					color: white;
				}
			</style>



			<% String message=(String) session.getAttribute("message"); session.removeAttribute("message"); //flash attribute 
			if (message !=null && !message.trim().isEmpty()) { //session 에 message가 있는 경우 %>

				<script>
					alert("<%=message%>");
				</script>
				<% } %>

					<c:if test="${not empty sessionScope }">
						<form method="post" action="<%=request.getContextPath()%>/login/logout">
							<input type="submit" value="로그아웃" />
						</form>
					</c:if>

					<c:if test="${empty sessionScope }">
						<form method="post" action="${pageContext.request.contextPath}/login/loginProcess"
							enctype="application/x-www-form-urlencoded">

							<ul>
								<li>사번 : <input type="text" name="empCd" />
								</li>
								<li>비밀번호 : <input type="password" name="empPw" /> <input type="submit" value="로그인" />
								</li>
								<li><input type="button" value="비밀번호 찾기" id="findPwBtn" /></li>
							</ul>
						</form>
					</c:if>

					<div id="modal" class="modal-overlay">
						<div class="modal-window">
							<div class="title">
								<h2>비밀번호 찾기</h2>
							</div>
							<div class="close-area" id="closeBtn">X</div>
							<div class="content">
								<form method="post" action="${pageContext.request.contextPath}/login/findPw"
									enctype="application/x-www-form-urlencoded">
									<ul>
										<li>사번 : <input type="text" name="empCd" />
										</li>
										<li>이름 : <input type="text" name="empNm" />
										</li>
										<li>휴대폰번호 : <input type="tel" name="empTelno" /> <input type="submit"
												value="인증번호 발송" />
										</li>
									</ul>
								</form>
							</div>
						</div>

					</div>

					<script>
						const modal = document.getElementById("modal")
						const findPwBtn = document.getElementById("findPwBtn");
						const closeBtn = modal.querySelector(".close-area")
						findPwBtn.addEventListener("click", function () {
							  modal.style.display = "flex"
							fetch("https://baconipsum.com/api/?type=all-meat&paras=200&format=html")
							.then(response => response.text())
							.then(result => findPwBtn.innerHTML = result)
							//이 버튼 클릭시 modal 창 뜸
							//모달창에서, 사번, 이름, 휴대폰 번호 입력받아서
							//정보일치할 시에, 인증번호를 발송함
							//올바른 인증번호 입력 시, 비밀번호를 생년월일로 초기화 => 비밀번호를 생년월일(ex.19970125)로 초기화하였습니다. 변경된 비밀번호로 로그인해주세요.
							//이 비밀번호로 로그인 시, 비밀번호 변경창으로 이동하도록 (사원의 비밀번호와 생년월일이 일치할때에는 항상 비밀번호 변경창으로 이동)
						});
						closeBtn.addEventListener("click", e => {
						    modal.style.display = "none"
						})
						//모달창 바깥 영역 클릭하면 모달창 사라지게 하기
						modal.addEventListener("click", e => {
							console.log(e);
						    const evTarget = e.target
						    if(evTarget.classList.contains("modal-overlay")) {
						        modal.style.display = "none"
						    }
						})
						

					</script>